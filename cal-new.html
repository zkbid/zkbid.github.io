<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>æ­£å¼€æ‹›æ ‡ - æœåŠ¡è´¹è®¡ç®—å™¨</title>
  <style>
    :root {
      --primary: #4361ee;
      --primary-light: #4895ef;
      --primary-dark: #3a0ca3;
      --secondary: #7209b7;
      --discount-color: #ff9e00;
      --cargo-color: #4361ee;
      --construction-color: #f72585;
      --service-color: #4cc9f0;
      --light: #f8f9fa;
      --dark: #212529;
      --gray: #6c757d;
      --gray-light: #e9ecef;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
      --shadow-hover: 0 15px 40px rgba(0, 0, 0, 0.12);
      --radius: 16px;
      --radius-sm: 10px;
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
      min-height: 100vh;
      color: var(--dark);
      line-height: 1.6;
      padding: 20px;
    }
    
    .app-container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    /* å¤´éƒ¨æ ·å¼ */
    .header {
      text-align: center;
      margin-bottom: 40px;
      position: relative;
    }
    
    .header h1 {
      font-size: 2.5rem;
      font-weight: 800;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin-bottom: 10px;
    }
    
    .header-subtitle {
      font-size: 1.1rem;
      color: var(--gray);
      max-width: 700px;
      margin: 0 auto 20px;
    }
    
    .header-decoration {
      height: 4px;
      width: 100px;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      margin: 0 auto;
      border-radius: 2px;
    }
    
    /* ä¸»å¡ç‰‡æ ·å¼ */
    .main-card {
      background: white;
      border-radius: var(--radius);
      border: none;
      box-shadow: var(--shadow);
      overflow: hidden;
      margin-bottom: 30px;
    }
    
    .card-header {
      background: linear-gradient(90deg, var(--primary), var(--primary-light));
      color: white;
      padding: 25px 30px;
      border-bottom: none;
    }
    
    .card-header h2 {
      margin: 0;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .card-body {
      padding: 30px;
    }
    
    /* é‡‘é¢è¾“å…¥åŒºåŸŸ */
    .amount-input-section {
      background: rgba(67, 97, 238, 0.03);
      border-radius: var(--radius-sm);
      padding: 25px;
      margin-bottom: 30px;
    }
    
    .input-label {
      font-weight: 600;
      margin-bottom: 15px;
      color: var(--dark);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .input-with-unit {
      display: flex;
      width: 100%;
      max-width: 600px;
    }
    
    .input-group-custom {
      border-radius: var(--radius-sm) 0 0 var(--radius-sm);
      overflow: hidden;
      border: 2px solid var(--gray-light);
      border-right: none;
      transition: var(--transition);
      flex: 1;
    }
    
    .input-group-custom:focus-within {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
    }
    
    .input-group-custom input {
      border: none;
      padding: 18px 20px;
      font-size: 1.2rem;
      font-weight: 500;
      width: 100%;
    }
    
    .input-group-custom input:focus {
      outline: none;
    }
    
    .unit-toggle {
      display: flex;
      border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
      overflow: hidden;
      border: 2px solid var(--gray-light);
      border-left: none;
    }
    
    .unit-option {
      padding: 0 25px;
      background: white;
      color: var(--gray);
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 90px;
    }
    
    .unit-option.active {
      background: var(--primary);
      color: white;
    }
    
    .unit-option:not(.active):hover {
      background: rgba(67, 97, 238, 0.05);
    }
    
    /* æŠ˜æ‰£ç‡è¾“å…¥åŒºåŸŸ */
    .discount-input-section {
      background: rgba(255, 158, 0, 0.03);
      border-radius: var(--radius-sm);
      padding: 25px;
      margin-top: 25px;
      border: 1px solid rgba(255, 158, 0, 0.1);
    }
    
    .discount-input-group {
      display: flex;
      align-items: center;
      gap: 15px;
      max-width: 400px;
    }
    
    .discount-input {
      display: flex;
      border: 2px solid rgba(255, 158, 0, 0.3);
      border-radius: var(--radius-sm);
      overflow: hidden;
      transition: var(--transition);
      flex: 1;
    }
    
    .discount-input:focus-within {
      border-color: var(--discount-color);
      box-shadow: 0 0 0 3px rgba(255, 158, 0, 0.2);
    }
    
    .discount-input input {
      border: none;
      padding: 15px 20px;
      font-size: 1.1rem;
      font-weight: 500;
      width: 100%;
      text-align: center;
    }
    
    .discount-percent {
      background: var(--discount-color);
      color: white;
      padding: 0 20px;
      font-weight: 600;
      display: flex;
      align-items: center;
    }
    
    .discount-slider {
      width: 100%;
      max-width: 400px;
      margin-top: 15px;
    }
    
    .discount-slider input[type="range"] {
      width: 100%;
      height: 8px;
      -webkit-appearance: none;
      background: linear-gradient(to right, #ff4444, #ff9e00, #4CAF50);
      border-radius: 4px;
      outline: none;
    }
    
    .discount-slider input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 24px;
      height: 24px;
      background: white;
      border: 3px solid var(--discount-color);
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    }
    
    .discount-quick-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 20px;
    }
    
    .discount-btn {
      padding: 8px 16px;
      border: 1px solid rgba(255, 158, 0, 0.3);
      background: rgba(255, 158, 0, 0.05);
      border-radius: 50px;
      color: var(--discount-color);
      font-weight: 500;
      transition: var(--transition);
      cursor: pointer;
    }
    
    .discount-btn:hover {
      background: rgba(255, 158, 0, 0.1);
      transform: translateY(-2px);
    }
    
    .discount-btn.active {
      background: var(--discount-color);
      color: white;
      border-color: var(--discount-color);
    }
    
    .discount-hint {
      font-size: 0.9rem;
      color: var(--gray);
      margin-top: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .quick-amounts {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 20px;
    }
    
    .quick-btn {
      padding: 10px 20px;
      border: 1px solid var(--gray-light);
      background: white;
      border-radius: 50px;
      color: var(--gray);
      font-weight: 500;
      transition: var(--transition);
      cursor: pointer;
    }
    
    .quick-btn:hover {
      border-color: var(--primary-light);
      color: var(--primary);
      transform: translateY(-2px);
    }
    
    .input-hint {
      font-size: 0.9rem;
      color: var(--gray);
      margin-top: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    /* ç»“æœå¡ç‰‡æ ·å¼ */
    .results-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 25px;
      margin-top: 20px;
    }
    
    .result-card {
      border-radius: var(--radius-sm);
      padding: 25px;
      color: white;
      transition: var(--transition);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
    }
    
    .result-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
    }
    
    .result-card.cargo {
      background: linear-gradient(135deg, var(--cargo-color), #5a7bf0);
    }
    
    .result-card.construction {
      background: linear-gradient(135deg, var(--construction-color), #ff3d8b);
    }
    
    .result-card.service {
      background: linear-gradient(135deg, var(--service-color), #6bd4f5);
    }
    
    .result-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 5px;
      background: rgba(255, 255, 255, 0.3);
    }
    
    .result-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    
    .result-title {
      font-weight: 600;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .result-icon {
      font-size: 1.5rem;
    }
    
    .result-amount {
      font-size: 2.5rem;
      font-weight: 800;
      margin: 15px 0;
      text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }
    
    .discount-applied {
      font-size: 0.9rem;
      opacity: 0.9;
      margin-top: 5px;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .original-amount {
      font-size: 1rem;
      text-decoration: line-through;
      opacity: 0.8;
      margin-top: 5px;
    }
    
    .result-details {
      font-size: 0.95rem;
      opacity: 0.9;
      margin-top: 15px;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
      padding-top: 15px;
    }
    
    /* è´¹ç‡è¯´æ˜ */
    .rate-info {
      background: rgba(67, 97, 238, 0.03);
      border-radius: var(--radius-sm);
      padding: 25px;
      margin-top: 30px;
    }
    
    .rate-table-container {
      overflow-x: auto;
      margin-top: 20px;
    }
    
    .rate-table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: var(--radius-sm);
      overflow: hidden;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
    }
    
    .rate-table th {
      background: rgba(67, 97, 238, 0.05);
      padding: 15px;
      text-align: center;
      font-weight: 600;
      color: var(--primary);
      border-bottom: 2px solid rgba(67, 97, 238, 0.1);
    }
    
    .rate-table td {
      padding: 15px;
      text-align: center;
      border-bottom: 1px solid var(--gray-light);
    }
    
    .rate-table tr:hover {
      background: rgba(67, 97, 238, 0.03);
    }
    
    /* é¡µè„š */
    .footer {
      text-align: center;
      padding: 30px 0;
      margin-top: 40px;
      color: var(--gray);
      border-top: 1px solid var(--gray-light);
    }
    
    .footer-logo {
      font-weight: 700;
      color: var(--primary);
      font-size: 1.2rem;
      margin-bottom: 10px;
    }
    
    /* æç¤ºå’Œè­¦å‘Š */
    .alert {
      padding: 15px;
      border-radius: var(--radius-sm);
      margin: 15px 0;
    }
    
    .alert-danger {
      background-color: #f8d7da;
      border: 1px solid #f5c6cb;
      color: #721c24;
    }
    
    .alert-info {
      background-color: #d1ecf1;
      border: 1px solid #bee5eb;
      color: #0c5460;
    }
    
    /* åŠ¨ç”» */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .fade-in {
      animation: fadeIn 0.5s ease-out;
    }
    
    /* å“åº”å¼è°ƒæ•´ */
    @media (max-width: 768px) {
      .header h1 {
        font-size: 2rem;
      }
      
      .input-with-unit {
        flex-direction: column;
        max-width: 100%;
      }
      
      .input-group-custom {
        border-radius: var(--radius-sm) var(--radius-sm) 0 0;
        border-right: 2px solid var(--gray-light);
        border-bottom: none;
      }
      
      .unit-toggle {
        border-radius: 0 0 var(--radius-sm) var(--radius-sm);
        border-left: 2px solid var(--gray-light);
        border-top: none;
        height: 60px;
      }
      
      .unit-option {
        padding: 0 15px;
        min-width: 0;
        flex: 1;
      }
      
      .discount-input-group {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .discount-input {
        width: 100%;
      }
      
      .results-container {
        grid-template-columns: 1fr;
      }
      
      .result-amount {
        font-size: 2rem;
      }
    }
    
    @media (max-width: 576px) {
      body {
        padding: 15px;
      }
      
      .header h1 {
        font-size: 1.8rem;
      }
      
      .card-body {
        padding: 20px;
      }
      
      .result-amount {
        font-size: 1.8rem;
      }
      
      .discount-quick-buttons {
        gap: 8px;
      }
      
      .discount-btn {
        padding: 6px 12px;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="app-container">
      <!-- å¤´éƒ¨ -->
      <header class="header fade-in">
        <h1>æ‹›æ ‡æœåŠ¡è´¹è®¡ç®—å™¨</h1>
        <p class="header-subtitle">æ ¹æ®[2002]1980å·æ–‡ã€å‘æ”¹åŠä»·æ ¼[2003]857å·ã€å‘æ”¹ä»·æ ¼[2011]534å·æ ‡å‡†è®¡ç®—ï¼Œä¸€é”®è®¡ç®—è´§ç‰©ã€å·¥ç¨‹ã€æœåŠ¡ä¸‰ç§ç±»å‹æ‹›æ ‡ä»£ç†æœåŠ¡è´¹</p>
        <div class="header-decoration"></div>
      </header>
      
      <!-- ä¸»å¡ç‰‡ -->
      <div class="main-card fade-in">
        <div class="card-header">
          <h2>ğŸ“Š æœåŠ¡è´¹è®¡ç®—å™¨</h2>
        </div>
        <div class="card-body">
          <!-- é‡‘é¢è¾“å…¥åŒºåŸŸ -->
          <div class="amount-input-section">
            <div class="input-label">
              ğŸ’° è¯·è¾“å…¥ä¸­æ ‡é‡‘é¢
            </div>
            
            <div class="input-with-unit">
              <div class="input-group input-group-custom">
                <input 
                  type="number" 
                  id="bidAmount"
                  placeholder="ä¾‹å¦‚ï¼š1500000"
                  step="0.01"
                  min="0"
                >
              </div>
              
              <div class="unit-toggle">
                <div class="unit-option active" id="unitYuan">
                  å…ƒ
                </div>
                <div class="unit-option" id="unitWan">
                  ä¸‡å…ƒ
                </div>
              </div>
            </div>
            
            <div class="input-hint">
              â„¹ï¸ è¯·è¾“å…¥æ•°å­—ï¼Œå¯ä½¿ç”¨å°æ•°ç‚¹
            </div>
            
            <!-- å¿«é€Ÿè¾“å…¥æŒ‰é’® -->
            <div class="quick-amounts" id="quickAmounts">
              <!-- åŠ¨æ€ç”Ÿæˆ -->
            </div>
            
            <!-- é”™è¯¯æç¤º -->
            <div id="errorMessage" class="alert alert-danger mt-3" style="display: none;">
              âš ï¸ <span id="errorText"></span>
            </div>
          </div>
          
          <!-- æŠ˜æ‰£ç‡è¾“å…¥åŒºåŸŸ -->
          <div class="discount-input-section fade-in">
            <div class="input-label">
              ğŸ·ï¸ æŠ˜æ‰£ç‡è®¾ç½®ï¼ˆå¯é€‰ï¼‰
            </div>
            
            <div class="discount-input-group">
              <div class="discount-input">
                <input 
                  type="number" 
                  id="discountRate"
                  value="100"
                  min="0"
                  max="100"
                  step="0.1"
                >
                <div class="discount-percent">%</div>
              </div>
              <div style="color: var(--discount-color); font-weight: 600; min-width: 100px;">
                æŠ˜æ‰£ï¼š<span id="discountDisplay">0%</span>
              </div>
            </div>
            
            <div class="discount-slider">
              <input 
                type="range" 
                id="discountSlider"
                min="0"
                max="100"
                step="1"
                value="100"
              >
            </div>
            
            <div class="discount-quick-buttons" id="discountQuickButtons">
              <!-- åŠ¨æ€ç”Ÿæˆ -->
            </div>
            
            <div class="discount-hint">
              â„¹ï¸ è®¾ç½®æŠ˜æ‰£ç‡åï¼Œè®¡ç®—ç»“æœå°†è‡ªåŠ¨åº”ç”¨æŠ˜æ‰£ã€‚é»˜è®¤100%è¡¨ç¤ºæ— æŠ˜æ‰£ã€‚
            </div>
            
            <!-- æŠ˜æ‰£æç¤º -->
            <div id="discountMessage" class="alert alert-info mt-3" style="display: none;">
              ğŸ’¡ <span id="discountText"></span>
            </div>
          </div>
          
          <!-- è®¡ç®—ç»“æœ -->
          <div id="resultsSection" style="display: none;">
            <h3 class="mb-4" style="color: var(--primary);">
              ğŸ“ˆ è®¡ç®—ç»“æœ
            </h3>
            
            <div class="results-container">
              <!-- è´§ç‰©æ‹›æ ‡ç»“æœ -->
              <div class="result-card cargo">
                <div class="result-header">
                  <div class="result-title">
                    ğŸ“¦ è´§ç‰©æ‹›æ ‡
                  </div>
                  <div class="result-percentage" id="cargoRate">
                    0%
                  </div>
                </div>
                
                <div class="result-amount" id="cargoAmount">
                  Â¥0.00
                </div>
                
                <div class="discount-applied" id="cargoDiscountApplied" style="display: none;">
                  ğŸ·ï¸ æŠ˜æ‰£å
                </div>
                
                <div class="original-amount" id="cargoOriginalAmount" style="display: none;">
                  åŸä»·ï¼šÂ¥0.00
                </div>
                
                <div class="result-details" id="cargoRange">
                  è´¹ç‡ï¼š-
                </div>
              </div>
              
              <!-- å·¥ç¨‹æ‹›æ ‡ç»“æœ -->
              <div class="result-card construction">
                <div class="result-header">
                  <div class="result-title">
                    ğŸ—ï¸ å·¥ç¨‹æ‹›æ ‡
                  </div>
                  <div class="result-percentage" id="constructionRate">
                    0%
                  </div>
                </div>
                
                <div class="result-amount" id="constructionAmount">
                  Â¥0.00
                </div>
                
                <div class="discount-applied" id="constructionDiscountApplied" style="display: none;">
                  ğŸ·ï¸ æŠ˜æ‰£å
                </div>
                
                <div class="original-amount" id="constructionOriginalAmount" style="display: none;">
                  åŸä»·ï¼šÂ¥0.00
                </div>
                
                <div class="result-details" id="constructionRange">
                  è´¹ç‡ï¼š-
                </div>
              </div>
              
              <!-- æœåŠ¡æ‹›æ ‡ç»“æœ -->
              <div class="result-card service">
                <div class="result-header">
                  <div class="result-title">
                    ğŸ¤ æœåŠ¡æ‹›æ ‡
                  </div>
                  <div class="result-percentage" id="serviceRate">
                    0%
                  </div>
                </div>
                
                <div class="result-amount" id="serviceAmount">
                  Â¥0.00
                </div>
                
                <div class="discount-applied" id="serviceDiscountApplied" style="display: none;">
                  ğŸ·ï¸ æŠ˜æ‰£å
                </div>
                
                <div class="original-amount" id="serviceOriginalAmount" style="display: none;">
                  åŸä»·ï¼šÂ¥0.00
                </div>
                
                <div class="result-details" id="serviceRange">
                  è´¹ç‡ï¼š-
                </div>
              </div>
            </div>
          </div>
          
          <!-- è´¹ç‡è¯´æ˜ -->
          <div class="rate-info fade-in">
            <h4 style="color: var(--primary); margin-bottom: 20px;">
              ğŸ“‹ è´¹ç‡æ ‡å‡†è¯´æ˜
            </h4>
            
            <div class="rate-table-container">
              <table class="rate-table">
                <thead>
                  <tr>
                    <th>ä¸­æ ‡é‡‘é¢</th>
                    <th style="color: var(--cargo-color);">è´§ç‰©æ‹›æ ‡</th>
                    <th style="color: var(--construction-color);">å·¥ç¨‹æ‹›æ ‡</th>
                    <th style="color: var(--service-color);">æœåŠ¡æ‹›æ ‡</th>
                  </tr>
                </thead>
                <tbody id="rateTableBody">
                  <!-- åŠ¨æ€ç”Ÿæˆ -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      
      <!-- é¡µè„š -->
      <footer class="footer fade-in">
        <div class="footer-logo">æ­£å¼€æ‹›æ ‡</div>
        <p>Â© 2020-2026 æ­£å¼€æ‹›æ ‡ ç‰ˆæƒæ‰€æœ‰</p>
        <p class="small" style="max-width: 600px; margin: 10px auto;">
          æ ¹æ®[2002]1980å·æ–‡ã€å‘æ”¹åŠä»·æ ¼[2003]857å·ã€å‘æ”¹ä»·æ ¼[2011]534å·æ ‡å‡†è®¡ç®—ã€‚è®¡ç®—ç»“æœä»…ä¾›å‚è€ƒï¼Œå®é™…è´¹ç”¨ä»¥åˆåŒä¸ºå‡†ã€‚
        </p>
      </footer>
    </div>
  </div>

  <script>
    // è´¹ç‡é…ç½®
    const RATE_CONFIG = {
      cargo: {
        ranges: [
          { max: 100, rate: 1.5, fixed: 0, label: "100ä¸‡å…ƒä»¥ä¸‹" },
          { max: 500, rate: 1.1, fixed: 15000, label: "100-500ä¸‡å…ƒ" },
          { max: 1000, rate: 0.8, fixed: 59000, label: "500-1000ä¸‡å…ƒ" },
          { max: 5000, rate: 0.5, fixed: 99000, label: "1000-5000ä¸‡å…ƒ" },
          { max: 10000, rate: 0.25, fixed: 299000, label: "5000ä¸‡-1äº¿å…ƒ" },
          { max: 50000, rate: 0.05, fixed: 424000, label: "1äº¿-5äº¿å…ƒ" },
          { max: 100000, rate: 0.035, fixed: 624000, label: "5äº¿-10äº¿å…ƒ" },
          { max: 500000, rate: 0.008, fixed: 799000, label: "10äº¿-50äº¿å…ƒ" },
          { max: 1000000, rate: 0.006, fixed: 1119000, label: "50äº¿-100äº¿å…ƒ" },
          { max: Infinity, rate: 0.004, fixed: 1419000, label: "100äº¿å…ƒä»¥ä¸Š" }
        ]
      },
      construction: {
        ranges: [
          { max: 100, rate: 1.0, fixed: 0, label: "100ä¸‡å…ƒä»¥ä¸‹" },
          { max: 500, rate: 0.7, fixed: 10000, label: "100-500ä¸‡å…ƒ" },
          { max: 1000, rate: 0.55, fixed: 38000, label: "500-1000ä¸‡å…ƒ" },
          { max: 5000, rate: 0.35, fixed: 65500, label: "1000-5000ä¸‡å…ƒ" },
          { max: 10000, rate: 0.2, fixed: 205500, label: "5000ä¸‡-1äº¿å…ƒ" },
          { max: 50000, rate: 0.05, fixed: 305500, label: "1äº¿-5äº¿å…ƒ" },
          { max: 100000, rate: 0.035, fixed: 505500, label: "5äº¿-10äº¿å…ƒ" },
          { max: 500000, rate: 0.008, fixed: 680500, label: "10äº¿-50äº¿å…ƒ" },
          { max: 1000000, rate: 0.006, fixed: 1000500, label: "50äº¿-100äº¿å…ƒ" },
          { max: Infinity, rate: 0.004, fixed: 1300500, label: "100äº¿å…ƒä»¥ä¸Š" }
        ]
      },
      service: {
        ranges: [
          { max: 100, rate: 1.5, fixed: 0, label: "100ä¸‡å…ƒä»¥ä¸‹" },
          { max: 500, rate: 0.8, fixed: 15000, label: "100-500ä¸‡å…ƒ" },
          { max: 1000, rate: 0.45, fixed: 47000, label: "500-1000ä¸‡å…ƒ" },
          { max: 5000, rate: 0.25, fixed: 69500, label: "1000-5000ä¸‡å…ƒ" },
          { max: 10000, rate: 0.1, fixed: 169500, label: "5000ä¸‡-1äº¿å…ƒ" },
          { max: 50000, rate: 0.05, fixed: 219500, label: "1äº¿-5äº¿å…ƒ" },
          { max: 100000, rate: 0.035, fixed: 419500, label: "5äº¿-10äº¿å…ƒ" },
          { max: 500000, rate: 0.008, fixed: 594500, label: "10äº¿-50äº¿å…ƒ" },
          { max: 1000000, rate: 0.006, fixed: 914500, label: "50äº¿-100äº¿å…ƒ" },
          { max: Infinity, rate: 0.004, fixed: 1214500, label: "100äº¿å…ƒä»¥ä¸Š" }
        ]
      }
    };

    // è´¹ç‡å±•ç¤ºè¡¨æ ¼æ•°æ®
    const RATE_RANGES = [
      { label: '100ä¸‡ä»¥ä¸‹', rates: { cargo: 1.5, construction: 1.0, service: 1.5 } },
      { label: '100ä¸‡-500ä¸‡', rates: { cargo: 1.1, construction: 0.7, service: 0.8 } },
      { label: '500ä¸‡-1000ä¸‡', rates: { cargo: 0.8, construction: 0.55, service: 0.45 } },
      { label: '1000ä¸‡-5000ä¸‡', rates: { cargo: 0.5, construction: 0.35, service: 0.25 } },
      { label: '5000ä¸‡-1äº¿', rates: { cargo: 0.25, construction: 0.2, service: 0.1 } },
      { label: '1äº¿-5äº¿', rates: { cargo: 0.05, construction: 0.05, service: 0.05 } },
      { label: '5äº¿-10äº¿', rates: { cargo: 0.035, construction: 0.035, service: 0.035 } },
      { label: '10äº¿-50äº¿', rates: { cargo: 0.008, construction: 0.008, service: 0.008 } },
      { label: '50äº¿-100äº¿', rates: { cargo: 0.006, construction: 0.006, service: 0.006 } },
      { label: '100äº¿ä»¥ä¸Š', rates: { cargo: 0.004, construction: 0.004, service: 0.004 } }
    ];

    // æŠ˜æ‰£ç‡å¿«æ·é€‰é¡¹
    const DISCOUNT_OPTIONS = [
      { value: 100, label: 'æ— æŠ˜æ‰£' },
      { value: 95, label: '95æŠ˜' },
      { value: 90, label: '9æŠ˜' },
      { value: 85, label: '85æŠ˜' },
      { value: 80, label: '8æŠ˜' },
      { value: 75, label: '75æŠ˜' },
      { value: 70, label: '7æŠ˜' },
      { value: 50, label: '5æŠ˜' }
    ];

    // DOMå…ƒç´ 
    const bidAmountInput = document.getElementById('bidAmount');
    const unitYuan = document.getElementById('unitYuan');
    const unitWan = document.getElementById('unitWan');
    const quickAmountsDiv = document.getElementById('quickAmounts');
    const errorMessageDiv = document.getElementById('errorMessage');
    const errorText = document.getElementById('errorText');
    const resultsSection = document.getElementById('resultsSection');
    const rateTableBody = document.getElementById('rateTableBody');
    
    // æŠ˜æ‰£ç›¸å…³å…ƒç´ 
    const discountRateInput = document.getElementById('discountRate');
    const discountSlider = document.getElementById('discountSlider');
    const discountDisplay = document.getElementById('discountDisplay');
    const discountQuickButtons = document.getElementById('discountQuickButtons');
    const discountMessageDiv = document.getElementById('discountMessage');
    const discountText = document.getElementById('discountText');
    
    // ç»“æœå…ƒç´ 
    const cargoAmount = document.getElementById('cargoAmount');
    const cargoRate = document.getElementById('cargoRate');
    const cargoRange = document.getElementById('cargoRange');
    const cargoDiscountApplied = document.getElementById('cargoDiscountApplied');
    const cargoOriginalAmount = document.getElementById('cargoOriginalAmount');
    
    const constructionAmount = document.getElementById('constructionAmount');
    const constructionRate = document.getElementById('constructionRate');
    const constructionRange = document.getElementById('constructionRange');
    const constructionDiscountApplied = document.getElementById('constructionDiscountApplied');
    const constructionOriginalAmount = document.getElementById('constructionOriginalAmount');
    
    const serviceAmount = document.getElementById('serviceAmount');
    const serviceRate = document.getElementById('serviceRate');
    const serviceRange = document.getElementById('serviceRange');
    const serviceDiscountApplied = document.getElementById('serviceDiscountApplied');
    const serviceOriginalAmount = document.getElementById('serviceOriginalAmount');

    // çŠ¶æ€
    let currentUnit = 'yuan';
    let currentAmount = '';
    let currentDiscount = 100; // é»˜è®¤100%
    let originalResults = {
      cargo: 0,
      construction: 0,
      service: 0
    };
    let currentRateInfo = {
      cargo: { rate: 0, range: '' },
      construction: { rate: 0, range: '' },
      service: { rate: 0, range: '' }
    };

    // åˆå§‹åŒ–
    function init() {
      setupEventListeners();
      generateRateTable();
      generateDiscountQuickButtons();
      updateQuickAmounts();
      updateDiscountDisplay();
      updateDiscountMessage();
    }

    // è®¾ç½®äº‹ä»¶ç›‘å¬
    function setupEventListeners() {
      // é‡‘é¢è¾“å…¥
      bidAmountInput.addEventListener('input', handleAmountChange);
      bidAmountInput.addEventListener('keyup', (e) => {
        if (e.key === 'Enter') {
          calculateFees();
        }
      });

      // å•ä½åˆ‡æ¢
      unitYuan.addEventListener('click', () => switchUnit('yuan'));
      unitWan.addEventListener('click', () => switchUnit('wan'));
      
      // æŠ˜æ‰£ç‡è¾“å…¥
      discountRateInput.addEventListener('input', handleDiscountChange);
      discountSlider.addEventListener('input', handleDiscountSliderChange);
    }

    // åˆ‡æ¢å•ä½
    function switchUnit(unit) {
      if (currentUnit === unit) return;
      
      currentUnit = unit;
      
      // æ›´æ–°UI
      unitYuan.classList.toggle('active', unit === 'yuan');
      unitWan.classList.toggle('active', unit === 'wan');
      
      // æ›´æ–°å ä½ç¬¦
      bidAmountInput.placeholder = unit === 'yuan' ? 'ä¾‹å¦‚ï¼š1500000' : 'ä¾‹å¦‚ï¼š150';
      
      // å¦‚æœæœ‰å½“å‰é‡‘é¢ï¼Œè½¬æ¢å¹¶æ›´æ–°
      if (currentAmount) {
        let newAmount;
        if (unit === 'yuan') {
          // ä»ä¸‡å…ƒè½¬æ¢ä¸ºå…ƒ
          newAmount = parseFloat(currentAmount) * 10000;
        } else {
          // ä»å…ƒè½¬æ¢ä¸ºä¸‡å…ƒ
          newAmount = parseFloat(currentAmount) / 10000;
        }
        bidAmountInput.value = newAmount;
        currentAmount = newAmount.toString();
      }
      
      updateQuickAmounts();
      calculateFees();
    }

    // å¤„ç†é‡‘é¢å˜åŒ–
    function handleAmountChange() {
      currentAmount = bidAmountInput.value;
      calculateFees();
    }

    // å¤„ç†æŠ˜æ‰£ç‡å˜åŒ–
    function handleDiscountChange() {
      let discountValue = parseFloat(discountRateInput.value);
      
      // éªŒè¯è¾“å…¥
      if (isNaN(discountValue)) {
        discountValue = 100;
      }
      
      // é™åˆ¶èŒƒå›´
      if (discountValue < 0) discountValue = 0;
      if (discountValue > 100) discountValue = 100;
      
      // æ›´æ–°æŠ˜æ‰£ç‡
      currentDiscount = discountValue;
      
      // æ›´æ–°æ»‘å—
      discountSlider.value = discountValue;
      
      // æ›´æ–°æ˜¾ç¤º
      updateDiscountDisplay();
      
      // é‡æ–°è®¡ç®—
      calculateFees();
    }

    // å¤„ç†æ»‘å—å˜åŒ–
    function handleDiscountSliderChange() {
      const discountValue = parseFloat(discountSlider.value);
      currentDiscount = discountValue;
      discountRateInput.value = discountValue;
      updateDiscountDisplay();
      calculateFees();
    }

    // è®¾ç½®æŠ˜æ‰£ç‡
    function setDiscountRate(value) {
      currentDiscount = value;
      discountRateInput.value = value;
      discountSlider.value = value;
      updateDiscountDisplay();
      updateDiscountQuickButtons();
      calculateFees();
    }

    // æ›´æ–°æŠ˜æ‰£æ˜¾ç¤º
    function updateDiscountDisplay() {
      discountDisplay.textContent = `${(100 - currentDiscount).toFixed(1)}%`;
    }

    // æ›´æ–°æŠ˜æ‰£æ¶ˆæ¯
    function updateDiscountMessage() {
      if (currentDiscount === 100) {
        discountMessageDiv.style.display = 'none';
        return;
      }
      
      const discountPercent = 100 - currentDiscount;
      discountText.textContent = `å·²åº”ç”¨ ${discountPercent.toFixed(1)}% æŠ˜æ‰£ï¼Œæœ€ç»ˆè´¹ç”¨ä¸ºåŸä»·çš„ ${currentDiscount.toFixed(1)}%`;
      discountMessageDiv.style.display = 'block';
    }

    // ç”ŸæˆæŠ˜æ‰£å¿«é€ŸæŒ‰é’®
    function generateDiscountQuickButtons() {
      discountQuickButtons.innerHTML = DISCOUNT_OPTIONS.map(option => 
        `<div class="discount-btn ${option.value === 100 ? 'active' : ''}" onclick="setDiscountRate(${option.value})">
          ${option.label}
        </div>`
      ).join('');
    }

    // æ›´æ–°æŠ˜æ‰£å¿«é€ŸæŒ‰é’®çŠ¶æ€
    function updateDiscountQuickButtons() {
      const buttons = discountQuickButtons.querySelectorAll('.discount-btn');
      buttons.forEach(button => {
        const value = parseInt(button.getAttribute('onclick').match(/\d+/)[0]);
        button.classList.toggle('active', value === currentDiscount);
      });
    }

    // æ›´æ–°å¿«é€Ÿé‡‘é¢æŒ‰é’®
    function updateQuickAmounts() {
      const amounts = currentUnit === 'yuan' 
        ? [10000, 50000, 100000, 500000, 1000000, 5000000, 10000000, 50000000, 100000000]
        : [1, 5, 10, 50, 100, 500, 1000, 5000, 10000];
      
      quickAmountsDiv.innerHTML = amounts.map(amount => 
        `<div class="quick-btn" onclick="setAmount(${amount})">${formatNumber(amount)}${currentUnit === 'yuan' ? 'å…ƒ' : 'ä¸‡å…ƒ'}</div>`
      ).join('');
    }

    // è®¾ç½®é‡‘é¢
    function setAmount(amount) {
      bidAmountInput.value = amount;
      currentAmount = amount.toString();
      calculateFees();
    }

    // è®¡ç®—æœåŠ¡è´¹
    function calculateFee(amountInWan, rateConfig) {
      if (amountInWan <= 0) return { fee: 0, rateInfo: { rate: 0, range: '' } };
      
      // æŸ¥æ‰¾é€‚ç”¨çš„è´¹ç‡åŒºé—´
      for (let i = 0; i < rateConfig.ranges.length; i++) {
        if (amountInWan <= rateConfig.ranges[i].max) {
          const range = rateConfig.ranges[i];
          const prevMax = i > 0 ? rateConfig.ranges[i-1].max : 0;
          const segmentAmount = Math.min(amountInWan, range.max) - prevMax;
          const fee = (segmentAmount * range.rate * 10000) / 100;
          
          let totalFee = fee;
          if (i > 0) {
            totalFee = fee + range.fixed;
          }
          
          return {
            fee: totalFee,
            rateInfo: {
              rate: range.rate,
              range: range.label
            }
          };
        }
      }
      
      return { fee: 0, rateInfo: { rate: 0, range: '' } };
    }

    // è®¡ç®—æ‰€æœ‰è´¹ç”¨
    function calculateFees() {
      // éªŒè¯è¾“å…¥
      const validation = validateInput();
      if (!validation.isValid) {
        showError(validation.message);
        hideResults();
        return;
      }
      
      hideError();
      updateDiscountMessage();
      
      // å°†é‡‘é¢ç»Ÿä¸€è½¬æ¢ä¸ºä¸‡å…ƒ
      let amountInWan;
      if (currentUnit === 'yuan') {
        amountInWan = parseFloat(currentAmount) / 10000;
      } else {
        amountInWan = parseFloat(currentAmount);
      }
      
      // è®¡ç®—åŸå§‹è´¹ç”¨
      const cargoResult = calculateFee(amountInWan, RATE_CONFIG.cargo);
      const constructionResult = calculateFee(amountInWan, RATE_CONFIG.construction);
      const serviceResult = calculateFee(amountInWan, RATE_CONFIG.service);
      
      // ä¿å­˜åŸå§‹ç»“æœå’Œè´¹ç‡ä¿¡æ¯
      originalResults.cargo = cargoResult.fee;
      originalResults.construction = constructionResult.fee;
      originalResults.service = serviceResult.fee;
      
      currentRateInfo.cargo = cargoResult.rateInfo;
      currentRateInfo.construction = constructionResult.rateInfo;
      currentRateInfo.service = serviceResult.rateInfo;
      
      // åº”ç”¨æŠ˜æ‰£
      const discountMultiplier = currentDiscount / 100;
      const discountedCargo = cargoResult.fee * discountMultiplier;
      const discountedConstruction = constructionResult.fee * discountMultiplier;
      const discountedService = serviceResult.fee * discountMultiplier;
      
      // æ›´æ–°UI
      updateResults(
        discountedCargo, cargoResult.rateInfo,
        discountedConstruction, constructionResult.rateInfo,
        discountedService, serviceResult.rateInfo
      );
      showResults();
    }

    // éªŒè¯è¾“å…¥
    function validateInput() {
      if (!currentAmount || currentAmount.trim() === '') {
        return { isValid: false, message: 'è¯·è¾“å…¥é‡‘é¢' };
      }
      
      const amount = parseFloat(currentAmount);
      if (isNaN(amount)) {
        return { isValid: false, message: 'è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—' };
      }
      
      if (amount < 0) {
        return { isValid: false, message: 'é‡‘é¢ä¸èƒ½ä¸ºè´Ÿæ•°' };
      }
      
      // æ£€æŸ¥æœ€å¤§å€¼ï¼ˆ1000äº¿å…ƒï¼‰
      const maxAmount = currentUnit === 'yuan' ? 100000000000 : 100000;
      if (amount > maxAmount) {
        return { isValid: false, message: 'é‡‘é¢è¿‡å¤§ï¼Œè¯·è¾“å…¥å°äº1000äº¿å…ƒçš„é‡‘é¢' };
      }
      
      return { isValid: true, message: '' };
    }

    // æ›´æ–°ç»“æœ
    function updateResults(cargoFee, cargoRateInfo, constructionFee, constructionRateInfo, serviceFee, serviceRateInfo) {
      // æ˜¯å¦æ˜¾ç¤ºæŠ˜æ‰£ä¿¡æ¯
      const showDiscountInfo = currentDiscount !== 100;
      
      // è´§ç‰©æ‹›æ ‡
      cargoAmount.textContent = `Â¥${formatCurrency(cargoFee)}`;
      cargoRate.textContent = `${cargoRateInfo.rate}%`;
      cargoRange.textContent = `è´¹ç‡ï¼š${cargoRateInfo.range}`;
      
      if (showDiscountInfo) {
        cargoDiscountApplied.style.display = 'flex';
        cargoOriginalAmount.style.display = 'block';
        cargoOriginalAmount.textContent = `åŸä»·ï¼šÂ¥${formatCurrency(originalResults.cargo)}`;
      } else {
        cargoDiscountApplied.style.display = 'none';
        cargoOriginalAmount.style.display = 'none';
      }
      
      // å·¥ç¨‹æ‹›æ ‡
      constructionAmount.textContent = `Â¥${formatCurrency(constructionFee)}`;
      constructionRate.textContent = `${constructionRateInfo.rate}%`;
      constructionRange.textContent = `è´¹ç‡ï¼š${constructionRateInfo.range}`;
      
      if (showDiscountInfo) {
        constructionDiscountApplied.style.display = 'flex';
        constructionOriginalAmount.style.display = 'block';
        constructionOriginalAmount.textContent = `åŸä»·ï¼šÂ¥${formatCurrency(originalResults.construction)}`;
      } else {
        constructionDiscountApplied.style.display = 'none';
        constructionOriginalAmount.style.display = 'none';
      }
      
      // æœåŠ¡æ‹›æ ‡
      serviceAmount.textContent = `Â¥${formatCurrency(serviceFee)}`;
      serviceRate.textContent = `${serviceRateInfo.rate}%`;
      serviceRange.textContent = `è´¹ç‡ï¼š${serviceRateInfo.range}`;
      
      if (showDiscountInfo) {
        serviceDiscountApplied.style.display = 'flex';
        serviceOriginalAmount.style.display = 'block';
        serviceOriginalAmount.textContent = `åŸä»·ï¼šÂ¥${formatCurrency(originalResults.service)}`;
      } else {
        serviceDiscountApplied.style.display = 'none';
        serviceOriginalAmount.style.display = 'none';
      }
    }

    // æ˜¾ç¤ºé”™è¯¯
    function showError(message) {
      errorText.textContent = message;
      errorMessageDiv.style.display = 'block';
    }

    // éšè—é”™è¯¯
    function hideError() {
      errorMessageDiv.style.display = 'none';
    }

    // æ˜¾ç¤ºç»“æœ
    function showResults() {
      resultsSection.style.display = 'block';
    }

    // éšè—ç»“æœ
    function hideResults() {
      resultsSection.style.display = 'none';
    }

    // ç”Ÿæˆè´¹ç‡è¡¨
    function generateRateTable() {
      rateTableBody.innerHTML = RATE_RANGES.map(range => `
        <tr>
          <td><strong>${range.label}</strong></td>
          <td>${range.rates.cargo}%</td>
          <td>${range.rates.construction}%</td>
          <td>${range.rates.service}%</td>
        </tr>
      `).join('');
    }

    // æ ¼å¼åŒ–è´§å¸
    function formatCurrency(value) {
      if (value === 0) return '0.00';
      
      // å¦‚æœé‡‘é¢è¿‡å¤§ï¼Œä½¿ç”¨ä¸‡å…ƒæ˜¾ç¤º
      if (value >= 100000000) {
        const valueInWan = value / 10000;
        return `${formatNumber(valueInWan)}ä¸‡`;
      }
      
      return new Intl.NumberFormat('zh-CN', {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      }).format(value);
    }

    // æ ¼å¼åŒ–æ•°å­—ï¼ˆæ·»åŠ åƒä½åˆ†éš”ç¬¦ï¼‰
    function formatNumber(value) {
      return new Intl.NumberFormat('zh-CN').format(value);
    }

    // åˆå§‹åŒ–åº”ç”¨
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>